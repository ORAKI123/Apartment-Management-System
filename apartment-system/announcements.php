<?php require_once 'includes/auth.php'; require_login(); require_once 'includes/db.php'; include 'includes/header.php';
if($_SERVER['REQUEST_METHOD']==='POST' && isset($_POST['add_announcement'])){ $title=$_POST['title']; $message=$_POST['message']; $pdo->prepare('INSERT INTO announcements (title,message) VALUES (?,?)')->execute([$title,$message]); }
$ann = $pdo->query('SELECT * FROM announcements ORDER BY created_at DESC')->fetchAll();
?>
<div class="d-flex"><aside class="sidebar"><h3>APARTMENT</h3></aside><main class="main"><h2>Announcements</h2><div class="form-box mb-3"><form method="post"><input name="title" class="form-control mb-2" placeholder="Title" required><textarea name="message" class="form-control mb-2" placeholder="Message" required></textarea><button name="add_announcement" class="btn btn-primary">Post</button></form></div><div class="table-responsive"><table class="table"><thead><tr><th>Title</th><th>Message</th><th>Date</th></tr></thead><tbody><?php foreach($ann as $a): ?><tr><td><?= htmlspecialchars($a['title']) ?></td><td><?= nl2br(htmlspecialchars($a['message'])) ?></td><td><?= $a['created_at'] ?></td></tr><?php endforeach; ?></tbody></table></div></main></div><?php include 'includes/footer.php'; ?>